function  [A_lin,B_lin, C, L, p_obs] = observer(alpha_ref)

x = alpha_ref;
omega_ref = 0;
K1 = 0;
K3 = 0;
K4 = 0;
b = 0;
C = [1, 0, 0; 0, 0, 1];

if x < 0
    omega_ref = 6659*x^4 + 1.083*10000 *x^3 + 6343 * x * x +1888*x - 1.157;
    b = 0.239927543450809;
    K1 = -10.548800723683954;
    K3 = 5.498506290874219e-05;
    K4 = 4.594429729616914;
%     f_u = 272.9 * u * u + 593.4 * u - 8.529;
else
    omega_ref = -1.905*100000*x^4 + 1.299*100000*x^3 - 3.225*10000 * x *x + 4233*x + 0.7921;
    b = 0.025936940902745;
    K1 = -10.577796958770156;
    K3 = -2.433475804656021e-05;
    K4 = 5.379206715771331;
%     f_u = -284.3 * u * u + 609 * u + 7.086;
end


A_lin = [0, 1, 0; K1*cos(alpha_ref), -b, -2*K3*omega_ref; 0, 0, -K4 ];
B_lin = [0;0; -K4];

p = eig(A_lin);
% p =  -0.1200 + 3.2063i
%      -0.1200 - 3.2063i
%      -4.5944 

p_real = real(p);
p_x = [8*p_real(1:2)+j*3*imag(p(1:2)) ; 12*p(3)];


% for down:
%p_x = [16*p_real(1:2)+j*8*imag(p(1:2)) ; 15*p(3)];
%   -0.1200 + 3.1148i
%   -0.1200 - 3.1148i
%   -4.5944 


disp(p)

L = place(A_lin', C', p_x);
p_obs = p_x;

% [A_lin,B_lin, C, L];
end
